//@ui5-bundle employee/Component-preload.js
sap.ui.predefine("employee/Component", ["sap/ui/core/UIComponent","employee/model/models"],(e,t)=>{"use strict";return e.extend("employee.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize();this._checkCurrentUser()},_checkCurrentUser:function(){let e=this.getModel("userAPIService");e.callFunction("/getCurrentUser",{method:"GET",success:e=>{console.log("User API Response:",e);let t=e.getCurrentUser;if(t.authenticated&&t.employeeFound){this.setModel(new sap.ui.model.json.JSONModel(t),"currentUser");this.getRouter().navTo("Employee",{},true)}else{sap.m.MessageBox.error("User not authorized. Please contact admin.")}},error:e=>{console.error("User API Error:",e);sap.m.MessageToast.show("Unable to fetch user information.")}})}})});
sap.ui.predefine("employee/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("employee.controller.App",{onInit(){}})});
sap.ui.predefine("employee/controller/Employee.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/BusyIndicator","sap/m/MessageToast","sap/ui/core/Fragment","sap/m/MenuItem","sap/m/Menu","sap/m/Dialog","sap/m/MessageBox"],(e,t,a,r,s,o,n,i,l)=>{"use strict";return e.extend("employee.controller.Employee",{onInit:function(){var e=this.getView();var t=new sap.ui.model.json.JSONModel({selectedDate:this._formatDateForModel(new Date),dailySummary:[],totalWeekHours:"0.00",currentWeek:"",isSubmitted:false,timeEntriesCount:0,commentsCount:0,timeEntries:[],hoursWorked:0,isTaskDisabled:false,newEntry:{},projects:[],nonProjectTypeName:"",nonProjects:[],workTypes:[],workType:"",dailyTotals:{monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0},weekDates:this._generateWeekDates(new Date)});e.setModel(t,"timeEntryModel");this._loadTimeEntriesFromBackend();var a=this.getOwnerComponent().getModel("timesheetServiceV2");a.read("/MyProjects",{success:function(t){var a=t.d?t.d.results:t.results;var r=a.map(function(e){return{projectName:e.projectName,status:e.status,managerName:e.projectOwnerName}});var s=new sap.ui.model.json.JSONModel;s.setData({assignedProjects:r});e.setModel(s,"assignedProjects")}.bind(this),error:function(e){console.error("Failed to load projects",e)}});this._loadReportData(a,e)},_getCurrentWeekMonday:function(){let e=new Date;let t=e.getDay();let a=t===0?-6:1-t;let r=new Date(e);r.setDate(e.getDate()+a);r.setHours(0,0,0,0);return r},onRefreshAnalytics:function(){console.log("Refreshing Reports‚Ä¶");var e=this.getOwnerComponent().getModel("timesheetServiceV2");var t=this.getView();sap.ui.core.BusyIndicator.show();this._loadReportData(e,t);setTimeout(()=>{sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Report data updated ‚ú®")},1e3)},onTabSelect:function(e){var t=e.getParameter("key");if(t==="reportsTab"){console.log("Reports tab activated ‚Üí refreshing data");var a=this.getOwnerComponent().getModel("timesheetServiceV2");var r=this.getView();sap.ui.core.BusyIndicator.show();this._loadReportData(a,r);setTimeout(()=>{sap.ui.core.BusyIndicator.hide()},800)}},_loadReportData:function(e,t){e.read("/BookedHoursOverview",{success:function(e){var a=e.d?e.d.results:e.results;var r=new sap.ui.model.json.JSONModel;r.setData({employeeProjectHours:a});t.setModel(r,"bookedHoursModel")},error:function(e){console.error("Failed to load Booked Hours Overview",e)}});e.read("/ProjectEngagementDuration",{success:function(e){var a=e.d?e.d.results:e.results;var r=new sap.ui.model.json.JSONModel;r.setData({employeeProjectDurations:a});t.setModel(r,"durationModel")},error:function(e){console.error("Failed to load Project Engagement Duration",e)}})},_generateWeekDates:function(e){var t=new Date(e);t.setDate(e.getDate()-e.getDay()+1);var a={};var r=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];r.forEach((e,r)=>{var s=new Date(t);s.setDate(t.getDate()+r);a[e]=s;a[e+"Formatted"]=this._formatDateForDisplay(s)});return a},_checkRowDeleteEligibility:function(e){return(parseFloat(e.mondayHours)||0)===0&&(parseFloat(e.tuesdayHours)||0)===0&&(parseFloat(e.wednesdayHours)||0)===0&&(parseFloat(e.thursdayHours)||0)===0&&(parseFloat(e.fridayHours)||0)===0&&(parseFloat(e.saturdayHours)||0)===0&&(parseFloat(e.sundayHours)||0)===0},_loadTimeEntriesFromBackend:function(){let e=this.getOwnerComponent().getModel("timesheetServiceV2");let t=this.getView();let r=t.getModel("timeEntryModel");if(!e){console.error("No OData model found");return}a.show(0);let s=this._getCurrentWeekMonday();let o=s.toISOString().split("T")[0];this._fetchWeekBoundaries(o).then(r=>{let s=r.getWeekBoundaries.weekStart;let o=r.getWeekBoundaries.weekEnd;this._updateWeekDates(new Date(s));e.read("/MyTimesheets",{success:function(e){a.hide();let r=e.results||[];let n=r.reduce((e,t)=>{let a=parseFloat(t.totalWeekHours)||0;return e+a},0);let i=this.getView().getModel("timeEntryModel");i.setProperty("/totalWeekHours",n);let l=i.getProperty("/weekDates");let d=e=>new Date(e);let u=r.filter(e=>{let t=e.weekStartDate?d(e.weekStartDate):null;let a=e.weekEndDate?d(e.weekEndDate):null;return t?.getTime()===s.getTime()&&a?.getTime()===o.getTime()});let y=u.map(e=>{let t=e.projectName&&e.projectName.trim()!==""?e.projectName:e.nonProjectTypeName||"";return{id:e.ID,totalWeekHours:e.totalWeekHours,projectId:e.project_ID,nonProjectId:e.nonProjectType_ID,projectName:t,originalProjectName:e.projectName,originalNonProjectName:e.nonProjectTypeName,workType:e.task,status:e.status,weekStart:e.weekStartDate,weekEnd:e.weekEndDate,mondayHours:e.mondayHours,tuesdayHours:e.tuesdayHours,wednesdayHours:e.wednesdayHours,thursdayHours:e.thursdayHours,fridayHours:e.fridayHours,saturdayHours:e.saturdayHours,sundayHours:e.sundayHours,mondayTaskDetails:e.mondayTaskDetails,tuesdayTaskDetails:e.tuesdayTaskDetails,wednesdayTaskDetails:e.wednesdayTaskDetails,thursdayTaskDetails:e.thursdayTaskDetails,fridayTaskDetails:e.fridayTaskDetails,saturdayTaskDetails:e.saturdayTaskDetails,sundayTaskDetails:e.sundayTaskDetails,dates:l}});y.forEach(e=>{e.canDelete=this._checkRowDeleteEligibility(e)});i.setProperty("/timeEntries",y);let c=this._calculateDailyTotals(y);i.setProperty("/dailyTotals",c);let m=Object.values(c).reduce((e,t)=>e+t,0);i.setProperty("/totalWeekHours",m.toFixed(2));let p=t.byId("timesheetTable");p?.getBinding("items")?.refresh(true)}.bind(this),error:function(e){a.hide();console.error(e);i.show("Failed to load timesheet")}})}).catch(e=>{a.hide();console.error(e);i.show("Week boundary fetch failed")})},_calculateDailyTotals:function(e){let t={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0};e.forEach(e=>{t.monday+=parseFloat(e.mondayHours||0);t.tuesday+=parseFloat(e.tuesdayHours||0);t.wednesday+=parseFloat(e.wednesdayHours||0);t.thursday+=parseFloat(e.thursdayHours||0);t.friday+=parseFloat(e.fridayHours||0);t.saturday+=parseFloat(e.saturdayHours||0);t.sunday+=parseFloat(e.sundayHours||0)});return t},_formatDateForModel:function(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},_getCurrentWeekDates:function(){let e=new Date;let t=e.getDay();let a=t===0?-6:1-t;let r=new Date(e);r.setDate(e.getDate()+a);let s=e=>e.toISOString().split("T")[0];let o=s(r);let n=s(new Date(r.getTime()+6*864e5));return{weekStart:o,weekEnd:n,monday:o,tuesday:s(new Date(r.getTime()+1*864e5)),wednesday:s(new Date(r.getTime()+2*864e5)),thursday:s(new Date(r.getTime()+3*864e5)),friday:s(new Date(r.getTime()+4*864e5)),saturday:s(new Date(r.getTime()+5*864e5)),sunday:n}},_formatDateForDisplay:function(e){if(!e)return"";let t=typeof e==="string"?new Date(e):e;let a={month:"short",day:"numeric"};return t.toLocaleDateString("en-US",a)},onCancelNewEntry:function(){this._oAddEntryDialog.close()},_isFutureDate:function(e,t,a){let r=new Date(e);return r>new Date(a)},onEntryDatePickerChange:function(e){var t=this;var a=this.getView().getModel("timeEntryModel");var r=this.getOwnerComponent().getModel("timesheetServiceV2");var s=e.getParameter("value");if(!s)return;var o=this._dayPropertyFromDate(s);var n=a.getProperty("/newEntry")||{};n.selectedDate=s;n.day=o;a.setProperty("/newEntry",n);var i=new Promise(e=>{r.read("/MyProjects",{success:t=>{let r=(t.results||[]).map(e=>({id:e.ID,name:e.projectName,isNonProject:false}));a.setProperty("/projects",r);e()},error:()=>{a.setProperty("/projects",[]);e()}})});var l=new Promise(e=>{r.read("/AvailableNonProjectTypes",{success:t=>{let r=(t.results||[]).map(e=>({id:e.ID,name:e.typeName,isNonProject:true,isLeave:e.typeName.toLowerCase().includes("leave")||e.typeName==="Sick Leave"}));a.setProperty("/nonProjects",r);e()},error:()=>{a.setProperty("/nonProjects",[]);e()}})});var d=new Promise(e=>{r.read("/AvailableTaskTypes",{success:t=>{let r=(t.results||[]).map(e=>({type:e.code,name:e.name}));a.setProperty("/workTypes",r);e()},error:()=>{a.setProperty("/workTypes",[]);e()}})});Promise.all([i,l,d]).then(()=>{let e=a.getProperty("/projects")||[];let r=a.getProperty("/nonProjects")||[];let o=a.getProperty("/workTypes")||[];let i=n.day;let l=t._getCurrentWeekDates();let d=t._isFutureDate(s,l.weekStart,l.weekEnd);let u=i==="saturday"||i==="sunday";let y=[];let c=r.filter(e=>!e.isLeave);if(d){if(u){y=c.map(e=>({id:e.id,name:e.name,isNonProject:true}))}else{y=r.map(e=>({id:e.id,name:e.name,isNonProject:true}))}a.setProperty("/isTaskDisabled",true);a.setProperty("/tasksToShow",[])}else if(u){y=[...e.map(e=>({id:e.id,name:e.name,isNonProject:false})),...c.map(e=>({id:e.id,name:e.name,isNonProject:true}))];a.setProperty("/isTaskDisabled",true);a.setProperty("/tasksToShow",[])}else{y=[...e,...r];a.setProperty("/isTaskDisabled",true);a.setProperty("/tasksToShow",[])}a.setProperty("/projectsToShow",y);let m=y.some(e=>e.id===(n.projectId||n.nonProjectTypeID));if(!m){n.projectId="";n.projectName="";n.nonProjectTypeID="";n.nonProjectTypeName="";n.workType="";a.setProperty("/newEntry",n);a.setProperty("/isTaskDisabled",true);a.setProperty("/tasksToShow",[])}})},_fetchWeekBoundaries:function(e){var t=this.getOwnerComponent().getModel("timesheetServiceV2");return new Promise((a,r)=>{t.callFunction("/getWeekBoundaries",{method:"GET",urlParameters:{workDate:e},success:function(e){a(e)},error:r})})},onAddEntry:function(){var e=this;var t=this.getView().getModel("timeEntryModel");var a=this.getOwnerComponent().getModel("timesheetServiceV2");var r=new Date;var s=this._currentWeekStartDate||new Date;var o=this._formatDateForModel(s);t.setProperty("/newEntry",{selectedDate:o,projectId:"",projectName:"",nonProjectTypeID:"",nonProjectTypeName:"",workType:"",hours:"",taskDetails:"",dailyComments:{}});var n=new Promise(function(e){a.read("/MyProjects",{success:function(a){var r=a.results.map(e=>({projectId:e.ID,projectName:e.projectName}));t.setProperty("/projects",r);e()},error:function(){t.setProperty("/projects",[]);e()}})});var i=new Promise(function(e){a.read("/AvailableNonProjectTypes",{success:function(a){var r=a.results.map(e=>({nonProjectTypeID:e.ID,nonProjectTypeName:e.typeName}));t.setProperty("/nonProjects",r);e()},error:function(){t.setProperty("/nonProjects",[]);e()}})});var l=new Promise(function(e){a.read("/AvailableTaskTypes",{success:function(a){var r=a.results.map(e=>({type:e.code,name:e.name}));t.setProperty("/workTypes",r);e()},error:function(){t.setProperty("/workTypes",[]);e()}})});Promise.all([n,i,l]).then(function(){var a=e._currentWeekStartDate||new Date;var r=new Date;r.setHours(0,0,0,0);a.setHours(0,0,0,0);var s=a>r;var o=t.getProperty("/projects")||[];var n=t.getProperty("/nonProjects")||[];if(s){var i=n.map(e=>({id:e.nonProjectTypeID,name:e.nonProjectTypeName,isNonProject:true}));t.setProperty("/projectsToShow",i);t.setProperty("/tasksToShow",[]);t.setProperty("/isTaskDisabled",true)}else{var i=[...o.map(e=>({id:e.projectId,name:e.projectName,isNonProject:false})),...n.map(e=>({id:e.nonProjectTypeID,name:e.nonProjectTypeName,isNonProject:true}))];t.setProperty("/projectsToShow",i);t.setProperty("/tasksToShow",t.getProperty("/workTypes")||[]);t.setProperty("/isTaskDisabled",true)}if(!e._oAddEntryDialog){e._oAddEntryDialog=sap.ui.xmlfragment(e.getView().getId(),"employee.Fragments.AddTimeEntry",e);e.getView().addDependent(e._oAddEntryDialog)}e._oAddEntryDialog.getContent().forEach(function(e){if(e.setValue)e.setValue("");if(e.setSelectedKey)e.setSelectedKey("");if(e.setSelectedIndex)e.setSelectedIndex(-1)});e._oAddEntryDialog.open()})},onProjectChange:function(e){var t=this.getView().getModel("timeEntryModel");var a=e.getSource().getSelectedItem();if(!a)return;var r=a.getKey();var s=a.getText();var o=t.getProperty("/projectsToShow")||[];var n=o.find(e=>e.id===r);if(!n)return;var i=t.getProperty("/newEntry")||{};if(n.isNonProject){t.setProperty("/newEntry/nonProjectTypeID",r);t.setProperty("/newEntry/nonProjectTypeName",s);t.setProperty("/newEntry/projectId","");t.setProperty("/newEntry/projectName","");t.setProperty("/newEntry/workType","");t.setProperty("/tasksToShow",[]);t.setProperty("/isTaskDisabled",true)}else{t.setProperty("/newEntry/projectId",r);t.setProperty("/newEntry/projectName",s);t.setProperty("/newEntry/nonProjectTypeID","");t.setProperty("/newEntry/nonProjectTypeName","");t.setProperty("/newEntry/workType","");t.setProperty("/tasksToShow",t.getProperty("/workTypes")||[]);t.setProperty("/isTaskDisabled",false)}t.setProperty("/newEntry",i)},onSaveNewEntry:function(){var e=this.getView().getModel("timeEntryModel");var t=e.getProperty("/newEntry")||{};var a=this;var r=parseFloat(t.hours)||0;if(r<=0||r>15){sap.m.MessageBox.error("Hours must be between 0 and 15");return false}var s=t.selectedDate;var o=this._dayPropertyFromDate(s);var n=o+"Hours";var i=o+"TaskDetails";var l={project_ID:null,nonProjectType_ID:null,projectName:t.projectName||"",nonProjectTypeName:t.nonProjectTypeName,nonProjectTypeID:t.nonProjectTypeID,task:t.workType||"",status:"Draft",isBillable:t.isBillable,mondayHours:"0.00",mondayTaskDetails:"",mondayDate:null,tuesdayHours:"0.00",tuesdayTaskDetails:"",tuesdayDate:null,wednesdayHours:"0.00",wednesdayTaskDetails:"",wednesdayDate:null,thursdayHours:"0.00",thursdayTaskDetails:"",thursdayDate:null,fridayHours:"0.00",fridayTaskDetails:"",fridayDate:null,saturdayHours:"0.00",saturdayTaskDetails:"",saturdayDate:null,sundayHours:"0.00",sundayTaskDetails:"",sundayDate:null};l[n]=r;l[i]=t.taskDetails||"";if(t.isBillable){l.nonProjectType_ID=t.projectId;l.project_ID=null}else{l.project_ID=t.projectId;l.nonProjectType_ID=null}this._fetchWeekBoundaries(s).then(e=>a._persistToBackend(l,s,e)).then(()=>{a._loadTimeEntriesFromBackend();sap.m.MessageToast.show("Timesheet saved!")}).catch(e=>{console.error("‚ùå Error while creating entry: ",e);sap.m.MessageBox.error("Failed to save timesheet.")});return true},_resetNewEntryFields:function(){let e=this.getView().getModel("timeEntryModel");e.setProperty("/newEntry",{projectId:"",projectName:"",nonProjectTypeID:"",nonProjectTypeName:"",workType:"",isBillable:false,taskDetails:"",hours:"",selectedDate:e.getProperty("/newEntry/selectedDate")})},onSaveAndNewEntry:function(){var e=this.getView().getModel("timeEntryModel");var t=e.getProperty("/newEntry")||{};var a=this;var r=parseFloat(t.hours)||0;if(r<=0||r>15){sap.m.MessageBox.error("Hours must be between 0 and 15");return false}var s=t.selectedDate;var o=this._dayPropertyFromDate(s);var n=o+"Hours";var i=o+"TaskDetails";var l={project_ID:null,nonProjectType_ID:null,projectName:t.projectName||"",nonProjectTypeName:t.nonProjectTypeName,nonProjectTypeID:t.nonProjectTypeID,task:t.workType||"",status:"Draft",isBillable:t.isBillable,mondayHours:"0.00",mondayTaskDetails:"",mondayDate:null,tuesdayHours:"0.00",tuesdayTaskDetails:"",tuesdayDate:null,wednesdayHours:"0.00",wednesdayTaskDetails:"",wednesdayDate:null,thursdayHours:"0.00",thursdayTaskDetails:"",thursdayDate:null,fridayHours:"0.00",fridayTaskDetails:"",fridayDate:null,saturdayHours:"0.00",saturdayTaskDetails:"",saturdayDate:null,sundayHours:"0.00",sundayTaskDetails:"",sundayDate:null};l[n]=r;l[i]=t.taskDetails||"";if(t.isBillable){l.nonProjectType_ID=t.projectId}else{l.project_ID=t.projectId}this._fetchWeekBoundaries(s).then(e=>a._persistToBackendNew(l,s,e)).then(()=>{a._loadTimeEntriesFromBackend();a._resetNewEntryFields();sap.m.MessageToast.show("Saved! Add another entry.")}).catch(e=>{console.error("‚ùå Error while saving entry: ",e);sap.m.MessageBox.error("Failed to save timesheet.")});return true},_persistToBackendNew:async function(e,t,a){var r=this.getOwnerComponent().getModel("timesheetServiceV2");let s=this;var o=this._dayPropertyFromDate(t);if(!o)return Promise.reject("Invalid day property");var n=this.getView().getModel("timeEntryModel").getProperty("/newEntry")||{};var i=Number(e[o+"Hours"])||0;var l=n.taskDetails||"";e[o+"TaskDetails"]=l;let d=await this._getWeekStartEndOData(t);console.log("Week boundary:",d);let u=d.weekStart;let y=d.weekEnd;let c={monday:"mondayDate",tuesday:"tuesdayDate",wednesday:"wednesdayDate",thursday:"thursdayDate",friday:"fridayDate",saturday:"saturdayDate",sunday:"sundayDate"};let m=c[o];function p(e){return`/Date(${new Date(e).getTime()})/`}var D=this.getOwnerComponent().getModel("currentUser").getData();let g=D.id;var w={employee_ID:g,weekStartDate:u,weekEndDate:y,project_ID:e.project_ID||null,projectName:e.projectName,nonProjectType_ID:e.nonProjectTypeID,nonProjectTypeName:e.nonProjectTypeName,task:e.task,status:"Draft",isBillable:true,mondayHours:e.mondayHours,mondayTaskDetails:e.mondayTaskDetails||"",mondayDate:null,tuesdayHours:e.tuesdayHours,tuesdayTaskDetails:e.tuesdayTaskDetails||"",tuesdayDate:null,wednesdayHours:e.wednesdayHours,wednesdayTaskDetails:e.wednesdayTaskDetails||"",wednesdayDate:null,thursdayHours:e.thursdayHours,thursdayTaskDetails:e.thursdayTaskDetails||"",thursdayDate:null,fridayHours:e.fridayHours,fridayTaskDetails:e.fridayTaskDetails||"",fridayDate:null,saturdayHours:e.saturdayHours,saturdayTaskDetails:e.saturdayTaskDetails||"",saturdayDate:null,sundayHours:e.sundayHours,sundayTaskDetails:e.sundayTaskDetails||"",sundayDate:null};w[m]=p(t);var h={[`${o}Hours`]:i.toFixed(2),[`${o}TaskDetails`]:l};return new Promise((a,n)=>{r.read("/MyTimesheets",{filters:[new sap.ui.model.Filter({path:"employee_ID",operator:"EQ",value1:g})],success:function(l){let d=l?.results||[];function u(e){if(!e)return null;try{return new Date(e).toISOString().split("T")[0]}catch(e){return null}}let y={monday:"mondayDate",tuesday:"tuesdayDate",wednesday:"wednesdayDate",thursday:"thursdayDate",friday:"fridayDate",saturday:"saturdayDate",sunday:"sundayDate"};let c=y[o];let m=d.filter(e=>{let a=u(e[c]);return a&&a===t});let p=m.reduce((e,t)=>e+(Number(t[o+"Hours"])||0),0);let D=m.find(e=>e.task===w.task);if(D){p-=Number(D[o+"Hours"])||0}let g=r.getProperty("/dailyTotals")||{};let f=Number(g[o]||0);let k=Number(i)||0;let T=p+Number(i);if(T>15){sap.m.MessageBox.error(`Woah steady there üòÖ You can only log 15 hours max on ${t}.`);if(s._oAddEntryDialog){s._oAddEntryDialog.close()}return}if(D){r.update("/MyTimesheets(guid'"+D.ID+"')",h,{success:function(e){if(s._oAddEntryDialog){s._oAddEntryDialog.close()}sap.m.MessageToast.show("Timesheet updated successfully!");a(e)},error:n})}else{r.create("/MyTimesheets",w,{success:function(t){let n=s.getView().getModel("timeEntryModel");n.setProperty("/newEntry",{project_ID:null,projectName:"",nonProjectTypeID:null,nonProjectTypeName:"",task:"",taskDetails:"",mondayHours:null,tuesdayHours:null,wednesdayHours:null,thursdayHours:null,fridayHours:null,saturdayHours:null,sundayHours:null});r.setProperty("/projectsToShow",[]);r.setProperty("/tasksToShow",[]);e[o+"Hours"]=null;e[o+"TaskDetails"]="";sap.m.MessageToast.show("Timesheet saved! Form reset successfully.");a(t)},error:function(e){sap.m.MessageBox.error("Failed to save timesheet. Check mandatory fields.");n(e)}})}},error:n})})},_getWeekStartEndOData:async function(e){if(!e){console.warn("No date provided to _getWeekStartEndOData");return{weekStart:null,weekEnd:null}}function t(e){if(/^\d{2}\/\d{2}\/\d{2}$/.test(e)){let[t,a,r]=e.split("/");return`20${r}-${t}-${a}`}return e}let a=t(e);try{let t=this.getOwnerComponent().getModel("timesheetServiceV2");let r=await new Promise((e,r)=>{t.callFunction("/getWeekBoundaries",{method:"GET",urlParameters:{workDate:a},success:e,error:r})});if(!r?.weekStart||!r?.weekEnd){console.warn("Backend did not return a valid week boundary for:",e);return{weekStart:null,weekEnd:null}}return{weekStart:r.weekStart,weekEnd:r.weekEnd}}catch(e){console.error("Failed fetching week boundaries from backend:",e);return{weekStart:null,weekEnd:null}}},onDeleteRows:function(e){let t=e.getSource().getBindingContext("timeEntryModel").getObject();this._deleteEntryIfZero(t)},_deleteEntryIfZero:function(e){sap.ui.core.BusyIndicator.show(0);const t=["mondayHours","tuesdayHours","wednesdayHours","thursdayHours","fridayHours","saturdayHours","sundayHours"];let a=t.every(t=>Number(e[t]||0)===0);if(!a){sap.m.MessageBox.information("Cannot delete ‚Äî this row has hours.");sap.ui.core.BusyIndicator.hide();return}const r=this.getOwnerComponent().getModel("timesheetServiceV2");const s="/MyTimesheets('"+e.id+"')";const o=this;r.remove(s,{success:function(){let t=o.getView().getModel("timeEntryModel").getProperty("/timeEntries")||[];let a=t.filter(t=>t.id!==e.id);o.getView().getModel("timeEntryModel").setProperty("/timeEntries",a);sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Deleted successfully.")},error:function(e){console.error("Delete failed",e);sap.ui.core.BusyIndicator.hide()}})},_persistToBackend:async function(e,t,a){var r=this.getOwnerComponent().getModel("timesheetServiceV2");let s=this;var o=this._dayPropertyFromDate(t);if(!o)return Promise.reject("Invalid day property");var n=this.getView().getModel("timeEntryModel").getProperty("/newEntry")||{};var i=Number(e[o+"Hours"])||0;var l=n.taskDetails||"";e[o+"TaskDetails"]=l;let d=await this._getWeekStartEndOData(t);let u=d.weekStart;let y=d.weekEnd;let c={monday:"mondayDate",tuesday:"tuesdayDate",wednesday:"wednesdayDate",thursday:"thursdayDate",friday:"fridayDate",saturday:"saturdayDate",sunday:"sundayDate"};let m=c[o];function p(e){return`/Date(${new Date(e).getTime()})/`}var D=this.getOwnerComponent().getModel("currentUser").getData();let g=D.id;var w={employee_ID:g,weekStartDate:u,weekEndDate:y,project_ID:e.project_ID||null,projectName:e.projectName,nonProjectType_ID:e.nonProjectTypeID,nonProjectTypeName:e.nonProjectTypeName,task:e.task,status:"Draft",isBillable:true,mondayHours:e.mondayHours,mondayTaskDetails:e.mondayTaskDetails||"",mondayDate:null,tuesdayHours:e.tuesdayHours,tuesdayTaskDetails:e.tuesdayTaskDetails||"",tuesdayDate:null,wednesdayHours:e.wednesdayHours,wednesdayTaskDetails:e.wednesdayTaskDetails||"",wednesdayDate:null,thursdayHours:e.thursdayHours,thursdayTaskDetails:e.thursdayTaskDetails||"",thursdayDate:null,fridayHours:e.fridayHours,fridayTaskDetails:e.fridayTaskDetails||"",fridayDate:null,saturdayHours:e.saturdayHours,saturdayTaskDetails:e.saturdayTaskDetails||"",saturdayDate:null,sundayHours:e.sundayHours,sundayTaskDetails:e.sundayTaskDetails||"",sundayDate:null};w[m]=p(t);return new Promise((e,a)=>{r.read("/MyTimesheets",{filters:[new sap.ui.model.Filter({path:"employee_ID",operator:"EQ",value1:g})],success:function(n){let l=n?.results||[];function d(e){if(!e)return null;try{return new Date(e).toISOString().split("T")[0]}catch(e){return null}}let u={monday:"mondayDate",tuesday:"tuesdayDate",wednesday:"wednesdayDate",thursday:"thursdayDate",friday:"fridayDate",saturday:"saturdayDate",sunday:"sundayDate"};let y=u[o];let c=l.filter(e=>{let a=d(e[y]);return a&&a===t});let m=c.reduce((e,t)=>e+(Number(t[o+"Hours"])||0),0);let p=m+Number(i);if(p>15){sap.m.MessageBox.error(`You can only log 15 hours max on ${t}.`);if(s._oAddEntryDialog){s._oAddEntryDialog.close()}return}r.create("/MyTimesheets",w,{success:function(t){if(s._oAddEntryDialog){s._oAddEntryDialog.close()}r.setProperty("/projectsToShow",[]);r.setProperty("/tasksToShow",[]);sap.m.MessageToast.show("Timesheet saved!");e(t)},error:function(e){sap.m.MessageBox.error("Failed to save timesheet. Check mandatory fields.");a(e)}})},error:a})})},validateDailyHours:async function(e,t,a,r=null){let s=await SELECT.from("MyTimesheets").where({employee_ID:e,workDate:t});let o=0;for(let e of s){o+=Number(e.hours||0)}if(r){let e=s.find(e=>e.ID===r);if(e){o-=Number(e.hours||0)}}return o+a<=15},_getWeekStartEndOData:async function(e){if(!e){console.warn("No date provided to _getWeekStartEndOData");return{weekStart:null,weekEnd:null}}let t=this._parseToDate(e);if(!t){return{weekStart:null,weekEnd:null}}let a=new Date;let r=this._getWeekRange(t);let s=this._getWeekRange(a);let o=r.start===s.start&&r.end===s.end;if(o){console.warn("Selected date is in CURRENT week ‚Üí Using Backend Boundaries");return await this._callBackendWeekBoundaryAPI(t)}console.warn("Selected date is NOT current week ‚Üí Using Local Calculation");return this._calculateWeekBoundaryFromDate(t)},_parseToDate:function(e){try{let t;if(e.includes("-")){let a=e.split("-");if(a.length!==3)return null;t=new Date(a[0],a[1]-1,a[2])}else if(e.includes("/")){let a=e.split("/");if(a.length!==3)return null;let r=Number(a[0]),s=Number(a[1]),o=Number(a[2]);if(r>12){t=new Date(o<100?2e3+o:o,s-1,r)}else{t=new Date(o<100?2e3+o:o,r-1,s)}}else return null;return isNaN(t.getTime())?null:t}catch{return null}},_calculateWeekBoundaryFromDate:function(e){let t=e.getDay();let a=t===0?-6:1-t;let r=new Date(e);r.setHours(5,30,0,0);r.setDate(e.getDate()+a);let s=new Date(r);s.setDate(r.getDate()+6);return{weekStart:`/Date(${r.getTime()})/`,weekEnd:`/Date(${s.getTime()})/`}},_getWeekRange:function(e){let t=new Date(e);let a=t.getDay()===0?-6:1-t.getDay();let r=new Date(t);r.setDate(t.getDate()+a);let s=new Date(r);s.setDate(r.getDate()+6);let o=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;return{start:o(r),end:o(s)}},_callBackendWeekBoundaryAPI:function(e){return new Promise((t,a)=>{try{if(!(e instanceof Date)||isNaN(e.getTime())){console.warn("Invalid date supplied to backend week boundary call.");return t({weekStart:null,weekEnd:null})}let a=e.getFullYear();let r=String(e.getMonth()+1).padStart(2,"0");let s=String(e.getDate()).padStart(2,"0");let o=`${a}-${r}-${s}`;let n=this.getOwnerComponent().getModel("timesheetServiceV2");let i=`/getWeekBoundaries?date='${o}'`;n.read(i,{success:e=>{if(e&&e.getWeekBoundaries.weekStart&&e.getWeekBoundaries.weekEnd){t({weekStart:e.getWeekBoundaries.weekStart,weekEnd:e.getWeekBoundaries.weekEnd})}else{console.warn("Backend returned no week boundary values");t({weekStart:null,weekEnd:null})}},error:e=>{console.error("Backend week boundary error:",e);t({weekStart:null,weekEnd:null})}})}catch(e){console.error("Unhandled error calling week boundary API:",e);t({weekStart:null,weekEnd:null})}})},_formatDateForOData:function(e){if(!e)return null;let[t,a,r]=e.split("/");return`datetime('${r}-${a}-${t}T00:00:00')`},_dayPropertyFromDate:function(e){if(!e)return undefined;let t,a,r;e=e.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e)){[r,a,t]=e.split("-")}else if(/^\d{1,2}\/\d{1,2}\/\d{2,4}$/.test(e)){let s=e.split("/");let o=parseInt(s[0],10);let n=parseInt(s[1],10);if(o<=12&&n>12){s=[s[1],s[0],s[2]]}t=s[0].padStart(2,"0");a=s[1].padStart(2,"0");r=s[2].length===2?"20"+s[2]:s[2]}else{return undefined}let s=new Date(Number(r),Number(a)-1,Number(t));if(isNaN(s.getTime())||s.getFullYear()!==Number(r)||s.getMonth()+1!==Number(a)||s.getDate()!==Number(t)){return undefined}let o=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];return o[s.getDay()]},_saveEditedDayHoursAuto:function(e,t,a,r){let s=this.getView().getModel("timeEntryModel");let o=this.getOwnerComponent().getModel("timesheetServiceV2");let n=s.getProperty("/timeEntries")||[];let i=n.findIndex(t=>t.id===e.id);if(i===-1){sap.m.MessageBox.error("Entry not found");return}function l(e){if(!e)return null;if(typeof e==="string"&&e.startsWith("/Date(")){let t=parseInt(e.match(/\/Date\((\d+)\)\//)[1],10);let a=new Date(t);return a.toISOString().split("T")[0]}if(e instanceof Date){return e.toISOString().split("T")[0]}return null}let d={monday:"monday",tuesday:"tuesday",wednesday:"wednesday",thursday:"thursday",friday:"friday",saturday:"saturday",sunday:"sunday"};let u=e.dates?e.dates[d[t]]:null;let y=u?Number(e[t+"Hours"]||0):0;let c=Number(a)||0;let m=n.reduce((e,a,r)=>{if(r===i){return e+c}return e+Number(a[t]||0)},0);if(m>=16){sap.m.MessageBox.error(`Total hours for ${t.charAt(0).toUpperCase()+t.slice(1)} cannot exceed 15.`);return}let p=s.getProperty("/dailyTotals")||{};let D=Number(p[t]||0);let g=D-y+c;if(c>=15){sap.m.MessageBox.error(`Total hours for ${t.charAt(0).toUpperCase()+t.slice(1)} cannot exceed 15.`);return}if(g>=15){sap.m.MessageBox.error(`Total hours for ${t.charAt(0).toUpperCase()+t.slice(1)} cannot exceed 15.`);return}let w=n[i][t+"TaskDetails"];let h=c-y;n[i][t]=c;n[i][t+"TaskDetails"]=r||"";s.setProperty("/timeEntries",n);let f={[`${t}Hours`]:c,[`${t}TaskDetails`]:r||""};sap.ui.core.BusyIndicator.show(0);let k=e.id?`/MyTimesheets(guid'${e.id}')`:"/MyTimesheets";let T=()=>{sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show(`${t.charAt(0).toUpperCase()+t.slice(1)} saved successfully`);let e=s.getProperty("/dailyTotals")||{};e[t]=n.reduce((e,a)=>e+Number(a[t]||0),0);s.setProperty("/dailyTotals",e);let a=Object.values(e).reduce((e,t)=>e+t,0);s.setProperty("/totalWeekHours",a.toFixed(2));this._loadTimeEntriesFromBackend()};let P=()=>{sap.ui.core.BusyIndicator.hide();n[i][t]=y;n[i][t+"TaskDetails"]=w;s.setProperty("/timeEntries",n);let e=s.getProperty("/dailyTotals")||{};e[t]=n.reduce((e,a)=>e+Number(a[t]||0),0);s.setProperty("/dailyTotals",e);s.setProperty("/totalWeekHours",Object.values(e).reduce((e,t)=>e+t,0).toFixed(2));sap.m.MessageBox.error("Failed to save entry")};if(e.id){o.update(k,f,{method:"PATCH",success:T,error:P})}else{o.create(k,f,{success:T,error:P})}},_capitalize:function(e){if(!e||typeof e!=="string")return"";return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},onEditDailyHours:function(e){var t=e.getSource();var a=t.data("day");var r=t.getBindingContext("timeEntryModel");if(!r){sap.m.MessageToast.show("Unable to get entry data");return}var s=r.getObject();this._currentEditEntry=s;this._currentEditDay=a;var s=this._currentEditEntry;var a=this._currentEditDay;if(!s||!a){sap.m.MessageToast.show("Unable to edit. Please try again.");return}var o=a+"Hours";var n=a+"TaskDetails";var i=a+"Date";var l=Number(s[o])||0;var d=s[n]||"";var u=this.getView().getModel("timeEntryModel").getProperty("/weekDates");var y=u[a];var c="";if(y){try{var m=new Date(y);c=m.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}catch(e){console.warn("‚ö† Failed to format date:",y,e);c=""}}var p=[];for(var D=0;D<=15;D++){p.push(new sap.ui.core.Item({key:D.toString(),text:D+" hour"+(D!==1?"s":"")}))}var g=new sap.m.ComboBox({selectedKey:l.toString(),items:p});var w=new sap.m.TextArea({value:d,rows:4,placeholder:"Describe work done..."});var h=new sap.m.Dialog({title:"Edit "+this._capitalize(a)+" Entry",contentWidth:"350px",titleAlignment:"Center",content:[new sap.m.VBox({items:[new sap.m.VBox({items:[new sap.m.Label({text:"Date:",design:"Bold"}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.Input({value:c,editable:false})]}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.VBox({items:[new sap.m.Label({text:"Project:",design:"Bold"}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.Input({value:s.projectName,editable:false})]}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.VBox({items:[new sap.m.Label({text:"Task Type:",design:"Bold"}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.Input({value:s.workType,editable:false})]}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.VBox({items:[new sap.m.Label({text:"Hours:",design:"Bold",required:true}).addStyleClass("sapUiTinyMarginBottom"),g]}).addStyleClass("sapUiTinyMarginBottom"),new sap.m.VBox({items:[new sap.m.Label({text:"Task Details:",design:"Bold"}).addStyleClass("sapUiTinyMarginBottom"),w.setRows(4).setWidth("100%")]})]}).addStyleClass("sapUiMediumMarginBeginEnd sapUiSmallMarginTopBottom")],beginButton:new sap.m.Button({text:"Save",type:"Emphasized",icon:"sap-icon://save",press:function(){var e=Number(g.getSelectedKey());var t=w.getValue();if(isNaN(e)||e<0||e>24){sap.m.MessageBox.error("Please select valid hours between 0 and 24");return}this._saveEditedDayHoursAuto(s,a,e,t);h.close()}.bind(this)}),endButton:new sap.m.Button({text:"Cancel",icon:"sap-icon://decline",press:function(){h.close()}}),afterClose:function(){h.destroy()}});this.getView().addDependent(h);h.open()},_validateMandatoryFields:function(e){if(!e){sap.m.MessageBox.error("No entry data found.");return false}if(!e.projectId||e.projectId.trim()===""){sap.m.MessageBox.error("Please select a Project.");return false}let t=parseFloat(e.hours);if(isNaN(t)||t<=0||t>15){sap.m.MessageBox.error("Hours must be between 0 and 15.");return false}if(!e.taskDetails||e.taskDetails.trim()===""){sap.m.MessageBox.error("Please enter Task Details.");return false}return true},_parseODataDate:function(e){if(!e)return null;let t=/\/Date\((\d+)\)\//.exec(e);return t?new Date(parseInt(t[1],10)):null},_loadWeekEntries:function(e){let t=this.getOwnerComponent().getModel("timesheetServiceV2");let a=this.getView().getModel("timeEntryModel");let r=this._formatDateForModel(e);let s=this._formatDateForModel(new Date(e.getFullYear(),e.getMonth(),e.getDate()+6));let o=`weekStartDate eq datetime'${r}T00:00:00' and weekEndDate eq datetime'${s}T00:00:00'`;console.log("Filter:",o);t.read("/MyTimesheets",{urlParameters:{$filter:o},success:function(e){sap.ui.core.BusyIndicator.hide();let t=e.d?.results||e.results||[];let o=t.filter(e=>{let t=e.weekStartDate?new Date(e.weekStartDate).toISOString().split("T")[0]:null;let a=e.weekEndDate?new Date(e.weekEndDate).toISOString().split("T")[0]:null;let o=new Date(r).toISOString().split("T")[0];let n=new Date(s).toISOString().split("T")[0];return t===o&&a===n});let n;if(o.length>0){n=o.map(e=>{let t=e.projectName?e.projectName:e.nonProjectTypeName||"";return{id:e.ID,totalWeekHours:e.totalWeekHours,projectId:e.project_ID,projectName:t,nonProjectType_ID:e.nonProjectType_ID,nonProjectTypeName:e.nonProjectTypeName,workType:e.task||"",status:e.status||"",weekStart:this._parseODataDate(e.weekStartDate),weekEnd:this._parseODataDate(e.weekEndDate),mondayHours:e.mondayHours||0,tuesdayHours:e.tuesdayHours||0,wednesdayHours:e.wednesdayHours||0,thursdayHours:e.thursdayHours||0,fridayHours:e.fridayHours||0,saturdayHours:e.saturdayHours||0,sundayHours:e.sundayHours||0,mondayTaskDetails:e.mondayTaskDetails||"",tuesdayTaskDetails:e.tuesdayTaskDetails||"",wednesdayTaskDetails:e.wednesdayTaskDetails||"",thursdayTaskDetails:e.thursdayTaskDetails||"",fridayTaskDetails:e.fridayTaskDetails||"",saturdayTaskDetails:e.saturdayTaskDetails||"",sundayTaskDetails:e.sundayTaskDetails||"",dates:a.getProperty("/weekDates")}});n.forEach(e=>{e.canDelete=this._checkRowDeleteEligibility(e)})}else{n=[];a.setProperty("/timeEntries",n);a.setProperty("/dailyTotals",{monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0});a.setProperty("/totalWeekHours",0);let e=this.getView().byId("timesheetTable");e?.getBinding("items")?.refresh(true)}this._applyWeekData(n)}.bind(this),error:function(e){console.error("Failed to load week entries",e)}.bind(this)})},_applyWeekData:function(e){let t=this.getView().getModel("timeEntryModel");t.setProperty("/timeEntries",e);let a=this._calculateDailyTotals(e);t.setProperty("/dailyTotals",a);let r=Object.values(a).reduce((e,t)=>e+t,0);t.setProperty("/totalWeekHours",r.toFixed(2));let s=this.getView().byId("timesheetTable");s?.getBinding("items")?.refresh(true)},_toODataDate:function(e){return`/Date(${new Date(e).getTime()})/`},_clearWeekEntries:function(){var e=this.getView().getModel("timeEntryModel");var t={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0};e.setProperty("/dailyTotals",t);e.setProperty("/timeEntries",[]);e.setProperty("/totalWeekHours","0.00")},_setDatePicker:function(e){let t=this.byId("datePicker");if(t&&e){t.setDateValue(e)}},onNextWeekTS:function(){var e=this.getView().getModel("timeEntryModel");var t=new Date(e.getProperty("/weekDates/monday"));t.setDate(t.getDate()+7);e.setProperty("/isNextWeek",true);this._currentWeekStartDate=t;sap.ui.core.BusyIndicator.show(0);this._updateWeekDates(t);this._loadWeekEntries(t);this._setDatePicker(t)},onPreviousWeekTS:function(){sap.ui.core.BusyIndicator.show(0);var e=this.getView().getModel("timeEntryModel");var t=new Date(e.getProperty("/weekDates/monday"));t.setDate(t.getDate()-7);e.setProperty("/isNextWeek",false);this._currentWeekStartDate=t;this._updateWeekDates(t);this._loadWeekEntries(t);this._setDatePicker(t)},onCurrentWeekTS:function(){sap.ui.core.BusyIndicator.show(0);var e=this._getCurrentWeekMonday();this._currentWeekStartDate=e;this._updateWeekDates(e);this._loadWeekEntries(e);this._setDatePicker(e)},_updateDailyTotals:function(){var e=this.getView().getModel("timeEntryModel");var t=e.getProperty("/timeEntries")||[];var a={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0};t.forEach(function(e){a.monday+=e.monday||0;a.tuesday+=e.tuesday||0;a.wednesday+=e.wednesday||0;a.thursday+=e.thursday||0;a.friday+=e.friday||0;a.saturday+=e.saturday||0;a.sunday+=e.sunday||0});e.setProperty("/dailyTotals",a)},onDatePickerChange:function(e){sap.ui.core.BusyIndicator.show(0);let t=e.getSource().getDateValue();if(!t)return;let a=t.getDay();let r=new Date(t);r.setDate(t.getDate()-(a===0?6:a-1));this._updateWeekDates(r);this._loadWeekEntries(r)},_updateWeekDates:function(e){var t=this.getView().getModel("timeEntryModel");var a=this._getMonday(e);var r={};["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].forEach((e,t)=>{let s=new Date(a);s.setDate(s.getDate()+t);r[e]=this._formatDateForModel(s);r[e+"Formatted"]=this._formatDateDisplay(s);r[e+"IsFuture"]=s>new Date});t.setProperty("/weekDates",r);var s=r.mondayFormatted+" - "+r.sundayFormatted+" "+a.getFullYear();t.setProperty("/currentWeek",s);var o=new Date;t.setProperty("/isCurrentWeek",o>=a&&o<=new Date(a.getTime()+6*24*60*60*1e3))},_getMonday:function(e){var t=e.getDay();var a=e.getDate()-t+(t===0?-6:1);var r=new Date(e);r.setDate(a);r.setHours(0,0,0,0);return r},_formatDateDisplay:function(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t[e.getMonth()]+" "+("0"+e.getDate()).slice(-2)},onTaskDetailPress:function(e){try{var t=e.getSource();var a=t.getBindingContext("timeEntryModel");if(!a){sap.m.MessageToast.show("Unable to get binding context");return}var r=a.getObject();var s=this.getView().getModel("timeEntryModel");var o=s.getProperty("/weekDates");if(!o){sap.m.MessageToast.show("Week dates not available");return}r.dailyComments=r.dailyComments||{};var n=this;var i=[{name:"Monday",hours:r.mondayHours||0,comment:r.mondayTaskDetails||"No task details",date:n._formatDateForDisplay(o.monday)},{name:"Tuesday",hours:r.tuesdayHours||0,comment:r.tuesdayTaskDetails||"No task details",date:n._formatDateForDisplay(o.tuesday)},{name:"Wednesday",hours:r.wednesdayHours||0,comment:r.wednesdayTaskDetails||"No task details",date:n._formatDateForDisplay(o.wednesday)},{name:"Thursday",hours:r.thursdayHours||0,comment:r.thursdayTaskDetails||"No task details",date:n._formatDateForDisplay(o.thursday)},{name:"Friday",hours:r.fridayHours||0,comment:r.fridayTaskDetails||"No task details",date:n._formatDateForDisplay(o.friday)},{name:"Saturday",hours:r.saturdayHours||0,comment:r.saturdayTaskDetails||"No task details",date:n._formatDateForDisplay(o.saturday)},{name:"Sunday",hours:r.sundayHours||0,comment:r.sundayTaskDetails||"No task details",date:n._formatDateForDisplay(o.sunday)}];var l=function(e){if(e===0){return"tsHoursRed"}else if(e>0&&e<8){return"tsHoursOrange"}else if(e>=8&&e<=15){return"tsHoursGreen"}return""};var d=i.map(function(e,t){return new sap.m.VBox({width:"100%",items:[new sap.m.HBox({justifyContent:"SpaceBetween",items:[new sap.m.Text({text:`${e.name} (${e.date})`,design:"Bold"}),new sap.m.Text({text:`${e.hours} hrs`,design:"Bold"}).addStyleClass(l(e.hours))]}).addStyleClass("tsDayHeader"),new sap.m.Text({text:e.comment,wrapping:true}).addStyleClass("tsDayComment"),...t<i.length-1?[(new sap.m.ToolbarSeparator).addStyleClass("tsSeparator")]:[]]}).addStyleClass("tsDayCard")});var u=new sap.m.Dialog({title:"Week Task Details",contentWidth:"300px",contentHeight:"70vh",stretchOnPhone:true,content:new sap.m.VBox({items:d}),endButton:new sap.m.Button({text:"Close",press:function(){u.close()}}),afterClose:function(){u.destroy()}});this.getView().addDependent(u);u.open()}catch(e){console.error("Error in onTaskDetailPress:",e)}},onProjectSelect:function(e){var t=e.getParameter("listItem");if(t){var a=t.getBindingContext().getObject();i.show("Selected project: "+a.projectName+" (Manager: "+a.managerName+")")}},onProfilePress:function(){var e=this.getOwnerComponent().getModel("timesheetServiceV2");var t=this.getView();if(!e){sap.m.MessageBox.error("OData model not found. Please check your manifest configuration.");return}sap.ui.core.BusyIndicator.show(0);e.read("/MyProfile",{success:function(e){sap.ui.core.BusyIndicator.hide();if(!e||!e.results||!e.results.length){sap.m.MessageBox.warning("No profile data found.");return}var a=e.results[0];var r={employeeID:a.employeeID||"",firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",managerName:a.managerName||"",managerEmail:a.managerEmail||"",activeStatus:a.isActive?"Yes":"No",changedBy:a.modifiedBy||"",userRole:a.roleName};var s=new sap.ui.model.json.JSONModel({profile:r});if(!this._oProfileDialog){this._oProfileDialog=sap.ui.xmlfragment("employee.Fragments.ProfileDialog",this);t.addDependent(this._oProfileDialog)}this._oProfileDialog.setModel(s,"view");var o=t.byId("employeeNameText");if(o){o.setText(r.firstName+" "+r.lastName)}this._oProfileDialog.open()}.bind(this),error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageBox.error("Failed to load profile data.");console.error(e)}})},onCloseProfileDialog:function(){if(this._oProfileDialog){this._oProfileDialog.close()}},onInfoPress:function(){var e=this.getView();if(!this._oCommentOptionsDialog){this._oCommentOptionsDialog=sap.ui.xmlfragment(e.getId(),"employee.Fragments.CommentOptions",this);e.addDependent(this._oCommentOptionsDialog)}this._initializeCommentData();this._oCommentOptionsDialog.open()},_initializeCommentData:function(){var e=this.getView().getModel();e.setProperty("/currentCommentType","daily");e.setProperty("/selectedDay","monday");e.setProperty("/dailyCommentText","");e.setProperty("/weeklyCommentText","");e.setProperty("/monthlyCommentText","");e.setProperty("/newCommentText","");e.setProperty("/needInput",false);var t=e.getProperty("/projects");var a=e.getProperty("/workTypes");if(t&&t.length>0){e.setProperty("/selectedProject",t[0].id)}if(a&&a.length>0){e.setProperty("/selectedWorkType",a[0].type)}e.setProperty("/selectedStatus","todo");e.setProperty("/selectedPriority","medium");var r=new Date;var s=r.getFullYear()+"-"+("0"+(r.getMonth()+1)).slice(-2)+"-"+("0"+r.getDate()).slice(-2);e.setProperty("/dueDateStart",s);e.setProperty("/dueDateEnd",s)},onSettingsPress:function(){l.information("Timesheet Settings:\n\n- Working hours: 8 hours/day\n- Future bookings allowed for Leave/Training only\n- Manager notifications for approved entry changes")},onViewReports:function(){var e=this.getOwnerComponent().getModel("timesheetServiceV2");if(!e){sap.m.MessageBox.error("OData model not found. Fix your manifest my dude.");return}sap.ui.core.BusyIndicator.show(0);e.read("/BookedHoursOverview",{success:function(e){sap.ui.core.BusyIndicator.hide();if(!e||!e.results||!e.results.length){sap.m.MessageBox.warning("Bro, no booked hours data found.");return}let t=e.results;let a="üìä Project Booked Hours Report\n\n";t.forEach(function(e){a+="üìå Project: "+e.Project+"\n";a+="üïí Allocated Hours: "+e.AllocatedHours+"\n";a+="‚è±Ô∏è Booked Hours: "+e.BookedHours+"\n";a+="üí° Remaining Hours: "+e.RemainingHours+"\n";a+="üìà Utilization: "+e.Utilization+"\n";a+="‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n"});sap.m.MessageBox.information(a,{title:"Booked Hours Overview"})},error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageBox.error("Failed to load Booked Hours Overview.");console.error("OData Error: ",e)}})},_formatODataDate:function(e){if(!e)return"";if(typeof e==="string"&&e.indexOf("/Date(")===0){var t=parseInt(e.replace(/\/Date\((\d+)\)\//,"$1"),10);e=new Date(t)}if(e instanceof Date){var a=("0"+e.getDate()).slice(-2);var r=("0"+(e.getMonth()+1)).slice(-2);var s=e.getFullYear();return a+"-"+r+"-"+s}return""}})});
sap.ui.predefine("employee/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"employee/Fragments/AddComment.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"><Dialog id="addCommentsDialog" title="Add Comments" class="sapUiContentPadding" contentWidth="30rem"><content><VBox id="_IDGenVBox9"><Label id="_IDGenLabel6" text="Daily Comment" class="sapUiTinyMarginTop"/><TextArea id="dailyCommentInput" value="{/newComment/daily}" placeholder="Enter daily comment" width="100%" class="sapUiTinyMarginBottom"/><Label id="_IDGenLabel7" text="Weekly Comment" class="sapUiTinyMarginTop"/><TextArea id="weeklyCommentInput" value="{/newComment/weekly}" placeholder="Enter weekly comment" width="100%" class="sapUiTinyMarginBottom"/><Label id="_IDGenLabel8" text="Monthly Comment" class="sapUiTinyMarginTop"/><TextArea id="monthlyCommentInput" value="{/newComment/monthly}" placeholder="Enter monthly comment" width="100%" class="sapUiTinyMarginBottom"/></VBox></content><beginButton><Button id="_IDGenButton9" text="Save" press="onSaveComments" type="Emphasized"/></beginButton><endButton><Button id="_IDGenButton10" text="Cancel" press="onCancelComments"/></endButton></Dialog></core:FragmentDefinition>',
	"employee/Fragments/AddDailyComment.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.ui.layout.form"><Dialog\n        id="addDailyCommentDialog"\n        title="Add Daily Comment"\n        contentWidth="600px"\n        contentHeight="400px"\n        resizable="true"><content><VBox id="_IDGenVBox" class="sapUiMediumMargin"><Label id="_IDGenLabel" text="Select Day" design="Bold" class="sapUiMediumMarginBottom" /><ComboBox\n                    id="dayComboBox"\n                    selectedKey="{/newDailyComment/day}"\n                    items="{/dailyComments}"\n                    placeholder="Select a Day"\n                    width="100%"><core:Item id="_IDGenItem" key="{day}" text="{day}" /></ComboBox><Label id="_IDGenLabel1" text="Comment" design="Bold" class="sapUiMediumMarginTop" /><TextArea\n                    id="dailyCommentTextArea"\n                    value="{/newDailyComment/comment}"\n                    rows="6"\n                    width="100%"\n                    placeholder="Enter your daily comment here..."\n                    growing="true"\n                    growingMaxLines="10"\n                    maxLength="1000"\n                    liveChange="onDailyCommentLiveChange" /><Text id="_IDGenText64" text="{= ${/newDailyComment/comment}.length + \' / 1000 characters\'}" class="sapUiTinyMarginTop" /></VBox></content><buttons><Button id="_IDGenButton1"\n                text="Cancel"\n                press="onCancelDailyComment"\n                type="Transparent" /><Button id="_IDGenButton2"\n                text="Save"\n                type="Emphasized"\n                press="onSaveDailyComment" /></buttons></Dialog></core:FragmentDefinition>',
	"employee/Fragments/AddTimeEntry.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.ui.layout.form"\n    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"><Dialog\n        id="addEntryDialog"\n        title="Add New Time Entry"\n        contentWidth="350px"\n        titleAlignment="Center"><content><VBox class="sapUiMediumMarginBeginEnd sapUiSmallMarginTopBottom"><VBox class="sapUiTinyMarginBottom"><Label text="Activity Date:" design="Bold" required="true" class="sapUiTinyMarginBottom" /><DatePicker\n                        value="{timeEntryModel>/newEntry/selectedDate}"\n                        placeholder="Select any date in the week"\n                        change="onEntryDatePickerChange"\n                        width="100%" /></VBox><VBox class="sapUiTinyMarginBottom"><Label text="Project:" design="Bold" required="true" class="sapUiTinyMarginBottom" /><ComboBox\n    selectedKey="{timeEntryModel>/newEntry/projectId}"\n    items="{timeEntryModel>/projectsToShow}"\n    placeholder="Select a Project"\n    change="onProjectChange"\n    width="100%"><core:Item key="{timeEntryModel>id}" text="{timeEntryModel>name}" /></ComboBox></VBox><VBox class="sapUiTinyMarginBottom"><Label text="Task:" design="Bold" required="true" class="sapUiTinyMarginBottom" /><ComboBox\n    items="{timeEntryModel>/tasksToShow}"\n    width="100%"\n    enabled="{= !${timeEntryModel>/isTaskDisabled} }"\n    selectedKey="{timeEntryModel>/newEntry/workType}"><core:Item key="{timeEntryModel>type}" text="{timeEntryModel>name}" /></ComboBox></VBox><VBox class="sapUiTinyMarginBottom"><Label text="Hours:" design="Bold" required="true" class="sapUiTinyMarginBottom" /><ComboBox\n                        selectedKey="{timeEntryModel>/newEntry/hours}"\n                        placeholder="Select Hours"\n                        width="100%"><core:Item key="1" text="1" /><core:Item key="2" text="2" /><core:Item key="3" text="3" /><core:Item key="4" text="4" /><core:Item key="5" text="5" /><core:Item key="6" text="6" /><core:Item key="7" text="7" /><core:Item key="8" text="8" /><core:Item key="9" text="9" /><core:Item key="10" text="10" /><core:Item key="11" text="11" /><core:Item key="12" text="12" /><core:Item key="13" text="13" /><core:Item key="14" text="14" /><core:Item key="15" text="15" /></ComboBox></VBox><VBox><Label text="Task Details:" design="Bold" required="true" class="sapUiTinyMarginBottom" /><TextArea\n                        id="taskDetailsTextArea"\n                        value="{timeEntryModel>/newEntry/taskDetails}"\n                        rows="4"\n                        placeholder="Enter task details"\n                        width="100%" /></VBox></VBox></content><buttons><Button\n                text="Save"\n                type="Emphasized"\n                icon="sap-icon://save"\n                press="onSaveNewEntry" /><Button\n                text="Save + New"\n                icon="sap-icon://add"\n                press="onSaveAndNewEntry" /><Button\n                text="Cancel"\n                icon="sap-icon://decline"\n                press="onCancelNewEntry" /></buttons></Dialog></core:FragmentDefinition>',
	"employee/Fragments/CommentOptions.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:layout="sap.ui.layout"\n    xmlns:f="sap.ui.layout.form"><Dialog\n        id="commentOptionsDialog"\n        title="Add Comments"\n        contentWidth="800px"\n        contentHeight="600px"\n        resizable="true"\n        draggable="true"><content><VBox id="_IDGenVBox10" class="sapUiMediumMargin"><SegmentedButton \n                    id="commentTypeSegmented" \n                    selectedKey="daily" \n                    selectionChange="onCommentTypeSelect"\n                    class="sapUiMediumMarginBottom"><items><SegmentedButtonItem id="_IDGenSegmentedButtonItem" key="daily" text="Daily"/><SegmentedButtonItem id="_IDGenSegmentedButtonItem1" key="weekly" text="Weekly"/><SegmentedButtonItem id="_IDGenSegmentedButtonItem2" key="monthly" text="Monthly"/></items></SegmentedButton><VBox id="dailyCommentSection" visible="{= ${/currentCommentType} === \'daily\' }"><f:SimpleForm id="_IDGenSimpleForm1"\n                        editable="true"\n                        layout="ResponsiveGridLayout"\n                        labelSpanXL="4"\n                        labelSpanL="4"\n                        labelSpanM="4"\n                        labelSpanS="12"\n                        adjustLabelSpan="false"\n                        emptySpanXL="0"\n                        emptySpanL="0"\n                        emptySpanM="0"\n                        emptySpanS="0"\n                        columnsXL="2"\n                        columnsL="2"\n                        columnsM="2"\n                        singleContainerFullSize="false"><f:content><Label id="_IDGenLabel9" text="Project" required="true"/><ComboBox id="_IDGenComboBox2" selectedKey="{/selectedProject}" items="{/projects}"><core:Item id="_IDGenItem1" key="{id}" text="{name}"/></ComboBox><Label id="_IDGenLabel10" text="Due Date"/><DateRangeSelection id="_IDGenDateRangeSelection" \n                                dateValue="{/dueDateStart}" \n                                secondDateValue="{/dueDateEnd}"\n                                displayFormat="MMM d"/><Label id="_IDGenLabel11" text="Work Type" required="true"/><ComboBox id="_IDGenComboBox3" selectedKey="{/selectedWorkType}" items="{/workTypes}"><core:Item id="_IDGenItem6" key="{type}" text="{name}"/></ComboBox><Label id="_IDGenLabel43" text="Status"/><ComboBox id="_IDGenComboBox4" selectedKey="{/selectedStatus}" items="{/statusOptions}"><core:Item id="_IDGenItem7" key="{key}" text="{text}"/></ComboBox><Label id="_IDGenLabel50" text="Priority"/><ComboBox id="_IDGenComboBox5" selectedKey="{/selectedPriority}" items="{/priorityOptions}"><core:Item id="_IDGenItem8" key="{key}" text="{text}"/></ComboBox></f:content></f:SimpleForm><Panel id="_IDGenPanel6" headerText="Description" expandable="true" expanded="true" class="sapUiMediumMarginTop"><VBox id="_IDGenVBox11" class="sapUiSmallMargin"><TextArea id="_IDGenTextArea" \n                                value="{/dailyCommentText}" \n                                rows="4" \n                                width="100%" \n                                placeholder="Schedule and attend an appointment with an endocrinologist to evaluate and address any issues related to hormonal imbalances or endocrine disorders."\n                                growing="true"\n                                growingMaxLines="10"/><CheckBox id="needInputCheckbox" text="Need Input" selected="{/needInput}" class="sapUiSmallMarginTop"/></VBox></Panel><Panel id="_IDGenPanel7" headerText="Comments" expandable="true" expanded="true" class="sapUiMediumMarginTop"><VBox id="_IDGenVBox22" class="sapUiSmallMargin"><VBox id="_IDGenVBox23"><HBox id="_IDGenHBox7" justifyContent="SpaceBetween" class="sapUiSmallMarginBottom"><VBox id="_IDGenVBox24"><Text id="_IDGenText37" text="John Smith ‚Ä¢ 17th Feb 2024" class="sapUiTinyMarginBottom"/><Text id="_IDGenText40" text="I\'ll do that task now, you can start working on another task!" class="sapUiTinyMarginBottom"/></VBox></HBox><HBox id="_IDGenHBox17" justifyContent="SpaceBetween" class="sapUiSmallMarginBottom"><VBox id="_IDGenVBox25"><Text id="_IDGenText41" text="John Smith ‚Ä¢ Just Now" class="sapUiTinyMarginBottom"/><Text id="_IDGenText42" text="Hello!" class="sapUiTinyMarginBottom"/></VBox></HBox></VBox><TextArea \n                                id="newCommentInput"\n                                value="{/newCommentText}"\n                                rows="3"\n                                width="100%"\n                                placeholder="Add a comment..."\n                                growing="true"\n                                class="sapUiSmallMarginTop"/><Button id="_IDGenButton13" \n                                text="Add Comment"\n                                type="Emphasized"\n                                press="onAddNewComment"\n                                class="sapUiTinyMarginTop"\n                                enabled="{= ${/newCommentText} &amp;&amp; ${/newCommentText}.length > 0 }"/></VBox></Panel></VBox><VBox id="weeklyCommentSection" visible="{= ${/currentCommentType} === \'weekly\' }"><f:SimpleForm id="_IDGenSimpleForm2"\n                        editable="true"\n                        layout="ResponsiveGridLayout"\n                        class="sapUiMediumMarginTop"><f:content><Label id="_IDGenLabel51" text="Week"/><Text id="_IDGenText43" text="{/currentWeek}"/><Label id="_IDGenLabel52" text="Weekly Summary" required="true"/><TextArea id="_IDGenTextArea1" \n                                value="{/weeklyCommentText}" \n                                rows="6" \n                                width="100%" \n                                placeholder="Enter your weekly summary and accomplishments..."\n                                growing="true"\n                                growingMaxLines="10"/></f:content></f:SimpleForm><Panel id="_IDGenPanel8" headerText="Weekly Goals" expandable="true" class="sapUiMediumMarginTop"><VBox id="_IDGenVBox47" class="sapUiSmallMargin"><CheckBox id="_IDGenCheckBox" text="Complete project milestones" selected="true"/><CheckBox id="_IDGenCheckBox1" text="Team meetings and coordination" selected="true"/><CheckBox id="_IDGenCheckBox2" text="Documentation updates" selected="false"/><CheckBox id="_IDGenCheckBox3" text="Client deliverables" selected="true"/></VBox></Panel></VBox><VBox id="monthlyCommentSection" visible="{= ${/currentCommentType} === \'monthly\' }"><f:SimpleForm id="_IDGenSimpleForm3"\n                        editable="true"\n                        layout="ResponsiveGridLayout"\n                        class="sapUiMediumMarginTop"><f:content><Label id="_IDGenLabel53" text="Month"/><Text id="_IDGenText44" text="{/currentMonth}"/><Label id="_IDGenLabel54" text="Monthly Review" required="true"/><TextArea id="_IDGenTextArea2" \n                                value="{/monthlyCommentText}" \n                                rows="8" \n                                width="100%" \n                                placeholder="Enter your monthly review, achievements, and plans for next month..."\n                                growing="true"\n                                growingMaxLines="12"/></f:content></f:SimpleForm><Panel id="_IDGenPanel9" headerText="Monthly Achievements" expandable="true" class="sapUiMediumMarginTop"><VBox id="_IDGenVBox48" class="sapUiSmallMargin"><CheckBox id="_IDGenCheckBox4" text="Project milestones completed" selected="true"/><CheckBox id="_IDGenCheckBox5" text="Team performance reviews" selected="false"/><CheckBox id="_IDGenCheckBox6" text="Budget and resource planning" selected="true"/><CheckBox id="_IDGenCheckBox7" text="Client satisfaction metrics" selected="true"/></VBox></Panel></VBox></VBox></content><buttons><Button id="_IDGenButton15" \n                text="Cancel"\n                press="onCancelCommentOption"/><Button id="_IDGenButton16" \n                text="Save Comment"\n                type="Emphasized"\n                press="onSaveCommentOption"/></buttons></Dialog></core:FragmentDefinition>',
	"employee/Fragments/DayFieldActions.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"><Dialog id="_IDGenDialog2" title="Day Field Actions" class="sapUiPopupWithPadding"><HBox id="_IDGenHBox" justifyContent="SpaceBetween"><Button id="_IDGenButton19" text="Edit" type="Emphasized" press="onEditDayField" /><Button id="_IDGenButton20" text="Delete" type="Reject" press="onDeleteDayField" /></HBox></Dialog></core:FragmentDefinition>',
	"employee/Fragments/EditComment.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.ui.layout.form"><Dialog\n        id="editCommentDialog"\n        title="Edit Comment"\n        contentWidth="600px"\n        contentHeight="400px"\n        resizable="true"><content><VBox id="_IDGenVBox19" class="sapUiMediumMargin"><Label id="_IDGenLabel2" text="Time Entry Details" design="Bold" class="sapUiMediumMarginBottom" /><HBox id="_IDGenHBox16" class="sapUiMediumMarginBottom"><VBox id="_IDGenVBox20" width="50%"><Label id="_IDGenLabel3" text="Project:" /><Text id="_IDGenText66" text="{/editEntry/projectName}" /></VBox><VBox id="_IDGenVBox21" width="50%"><Label id="_IDGenLabel4" text="Work Type:" /><Text id="_IDGenText67" text="{/editEntry/workTypeName}" /></VBox></HBox><Label id="_IDGenLabel5" text="Comment" design="Bold" class="sapUiMediumMarginTop" /><TextArea\n                    id="editCommentTextArea"\n                    value="{/editEntry/comment}"\n                    rows="6"\n                    width="100%"\n                    placeholder="Edit your comment here..."\n                    growing="true"\n                    growingMaxLines="10"\n                    maxLength="1000"\n                    liveChange="onCommentLiveChange" /><Text id="_IDGenText68" text="{= ${/editEntry/comment}.length + \' / 1000 characters\'}" class="sapUiTinyMarginTop" /></VBox></content><buttons><Button id="_IDGenButton22"\n                text="Cancel"\n                press="onCancelEditComment"\n                type="Transparent" /><Button id="_IDGenButton23"\n                text="Save"\n                type="Emphasized"\n                press="onSaveEditComment" /></buttons></Dialog></core:FragmentDefinition>',
	"employee/Fragments/EditDayHours.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:f="sap.ui.layout.form"><Dialog\n        id="_IDGenDialog"\n        title="Edit Hours for {/editDayHours/day}"\n        class="sapUiPopupWithPadding"><content><VBox id="_IDGenVBox2" class="sapUiSmallMargin"><Label id="_IDGenLabel12" text="Hours" /><Input\n                    id="hoursInput"\n                    type="Number"\n                    value="{/editDayHours/hours}"\n                    liveChange="onFragmentHoursChange"\n                    placeholder="Enter hours (0-24)" /></VBox></content><beginButton><Button id="_IDGenButton5"\n                text="Save"\n                type="Emphasized"\n                press="onSaveDayHours" /></beginButton><endButton><Button id="_IDGenButton6"\n                text="Cancel"\n                press="onCancelDayHours" /></endButton></Dialog></core:FragmentDefinition>',
	"employee/Fragments/EditHoursDialog.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"><Dialog id="_IDGenDialog1"\n        title="Edit Hours"\n        contentWidth="300px"\n        afterClose="onAfterCloseEditDialog"><content><VBox id="_IDGenVBox3" class="sapUiSmallMargin"><Label\n                    id="projectNameLabel"\n                    text="Project: "\n                    class="sapUiTinyMarginBottom"/><Label\n                    id="workTypeNameLabel"\n                    text="Work Type: "\n                    class="sapUiTinyMarginBottom"/><Label id="_IDGenLabel36"\n                    text="Enter Hours (0-24):"\n                    class="sapUiSmallMarginTop"/><Input\n                    id="editHoursInput"\n                    type="Number"\n                    placeholder="Enter hours (0-24)"\n                    liveChange="onEditHoursLiveChange"\n                    class="sapUiTinyMarginTop"/></VBox></content><beginButton><Button id="_IDGenButton4"\n                text="Save"\n                type="Emphasized"\n                press="onSaveEditHours"/></beginButton><endButton><Button id="_IDGenButton14"\n                text="Cancel"\n                press="onCancelEditHours"/></endButton></Dialog></core:FragmentDefinition>',
	"employee/Fragments/EditTimeEntry.fragment.xml":'\n<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:f="sap.ui.layout.form"><Dialog id="editTimeEntryDialog" title="Edit Time Entry" class="sapUiPopupWithPadding"><content><f:SimpleForm id="editTimeEntryForm" editable="true" layout="ResponsiveGridLayout" columnsL="1" columnsM="1"><f:content><Label id="editProjectLabel" text="Project"/><ComboBox id="editProjectComboBox"\n                        selectedKey="{/editEntry/projectId}"\n                        items="{/assignedProjects}"\n                        editable="false"><core:Item id="editProjectItem" key="{projectId}" text="{projectName}"/></ComboBox><Label id="editTaskLabel" text="Task"/><ComboBox id="editTaskComboBox"\n                        selectedKey="{/editEntry/workType}"\n                        items="{/workTypes}"\n                        editable="false"><core:Item id="editTaskItem" key="{type}" text="{name}"/></ComboBox><Label id="editCommentLabel" text="Task Details"/><TextArea id="editCommentTexetArea"\n                        value="{/editEntry/comment}"\n                        growing="true"\n                        growingMaxLines="5"\n                        liveChange="onTaskDetailsLiveChange"\n                        placeholder="Enter task details"/><Label id="editHoursLabel" text="Hours"/><HBox id="editHoursHBox"><VBox id="editMondayVBox" class="sapUiSmallMarginEnd"><Label id="editMondayLabel" text="Monday"/><Input id="editMondayInput"\n                                value="{path: \'/editEntry/monday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editTuesdayVBox" class="sapUiSmallMarginEnd"><Label id="editTuesdayLabel" text="Tuesday"/><Input id="editTuesdayInput"\n                                value="{path: \'/editEntry/tuesday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editWednesdayVBox" class="sapUiSmallMarginEnd"><Label id="editWednesdayLabel" text="Wednesday"/><Input id="editWednesdayInput"\n                                value="{path: \'/editEntry/wednesday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editThursdayVBox" class="sapUiSmallMarginEnd"><Label id="editThursdayLabel" text="Thursday"/><Input id="editThursdayInput"\n                                value="{path: \'/editEntry/thursday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editFridayVBox" class="sapUiSmallMarginEnd"><Label id="editFridayLabel" text="Friday"/><Input id="editFridayInput"\n                                value="{path: \'/editEntry/friday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editSaturdayVBox" class="sapUiSmallMarginEnd"><Label id="editSaturdayLabel" text="Saturday"/><Input id="editSaturdayInput"\n                                value="{path: \'/editEntry/saturday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox><VBox id="editSundayVBox"><Label id="editSundayLabel" text="Sunday"/><Input id="editSundayInput"\n                                value="{path: \'/editEntry/sunday\', type: \'sap.ui.model.type.Float\', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}}"\n                                change="onFragmentHoursChange"\n                                width="60px"/></VBox></HBox></f:content></f:SimpleForm></content><beginButton><Button id="editCancelButton" text="Cancel" press="onCancelEditEntry"/></beginButton><endButton><Button id="editSaveButton" text="Save" type="Emphasized" press="onSaveEditedEntry"/></endButton></Dialog></core:FragmentDefinition>',
	"employee/Fragments/ProfileDialog.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:f="sap.ui.layout.form"><Dialog\n        id="profileDialog"\n        title="Employee Profile"\n        class="sapUiPopupWithPadding"\n        contentWidth="500px"\n        afterClose="onCloseProfileDialog"><f:SimpleForm id="_IDGenSimpleForm"\n            editable="false"\n            layout="ResponsiveGridLayout"\n            labelSpanXL="4"\n            labelSpanL="4"\n            labelSpanM="4"\n            columnsXL="2"\n            columnsL="2"\n            columnsM="2"><f:content><Label id="_IDGenLabel13" text="Employee ID"/><Text id="_IDGenText" text="{view>/profile/employeeID}"/><Label id="_IDGenLabel14" text="First Name"/><Text id="_IDGenText1" text="{view>/profile/firstName}"/><Label id="_IDGenLabel15" text="Last Name"/><Text id="_IDGenText11" text="{view>/profile/lastName}"/><Label id="_IDGenLabel16" text="Email"/><Text id="_IDGenText12" text="{view>/profile/email}"/><Label id="_IDGenLabel17" text="Manager Name"/><Text id="_IDGenText13" text="{view>/profile/managerName}"/><Label id="_IDGenLabel18" text="Manager Email"/><Text id="_IDGenText14" text="{view>/profile/managerEmail}"/><Label id="_IDGenLabel19" text="Active Status"/><ObjectStatus id="_IDGenObjectStatus"\n                    text="{view>/profile/activeStatus}"\n                    state="{= ${view>/profile/activeStatus} === \'Yes\' ? \'Success\' : \'Error\' }"/><Label id="_IDGenLabel20" text="Changed By"/><Text id="_IDGenText15" text="{view>/profile/changedBy}"/><Label id="_IDGenLabel21" text="User Role"/><Text id="_IDGenText27" text="{view>/profile/userRole}"/></f:content></f:SimpleForm><buttons><Button id="_IDGenButton3" text="Close" type="Emphasized" press="onCloseProfileDialog"/></buttons></Dialog></core:FragmentDefinition>\n',
	"employee/i18n/i18n.properties":'# This is the resource bundle for employee\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Employee\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Employee',
	"employee/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"employee","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.19.5","toolsId":"c27cd793-b698-444d-a1df-1ad5d4a8a0d5"},"dataSources":{"mainService":{"uri":"/odata/v4/employee/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}},"timesheetServiceV2":{"uri":"/odata/v2/employee/","type":"OData","settings":{"odataVersion":"2.0","annotations":[]}},"userAPIService":{"uri":"/odata/v2/user-api/","type":"OData","settings":{"odataVersion":"2.0","annotations":[]}}},"crossNavigation":{"inbounds":{"employee-display":{"semanticObject":"employee","action":"display","title":"Employee Portal","subTitle":"Employee Dashboard","icon":"sap-icon://employee","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":false,"dependencies":{"minUI5Version":"1.142.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"employee.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"timesheetServiceV2":{"dataSource":"timesheetServiceV2","type":"sap.ui.model.odata.v2.ODataModel","settings":{"useBatch":false,"defaultBindingMode":"TwoWay","defaultOperationMode":"Server","defaultUpdateMethod":"MERGE"}},"userAPIService":{"dataSource":"userAPIService","type":"sap.ui.model.odata.v2.ODataModel"}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","viewPath":"employee.view","async":true},"routes":[{"pattern":"","name":"employee","target":"employee"}],"targets":{"employee":{"viewName":"Employee","viewId":"employee","viewLevel":1}}},"rootView":{"viewName":"employee.view.App","type":"XML","id":"App","async":true},"flexBundle":false},"sap.cloud":{"public":true,"service":"timesheet-application"}}',
	"employee/view/App.view.xml":'<mvc:View controllerName="employee.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"employee/view/Employee.view.xml":'<?xml version="1.0" encoding="UTF-8"?><mvc:View\n    controllerName="employee.controller.Employee"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:layout="sap.ui.layout"\n    xmlns:table="sap.ui.table"\n    xmlns:f="sap.ui.layout.form"\n    displayBlock="true"><Page id="mainPage" title="Weekly Timesheet" showHeader="true"><headerContent><Button id="profileButton" icon="sap-icon://person-placeholder" tooltip="My Profile" press="onProfilePress" class="sapUiTinyMarginEnd"/><Button id="infoButton" icon="sap-icon://information" tooltip="Add Comments" press="onInfoPress" class="sapUiTinyMarginEnd"/><Button id="settingsBtn" icon="sap-icon://action-settings" tooltip="Settings" press="onSettingsPress"/><Button id="reportsBtn" icon="sap-icon://business-objects-experience" tooltip="View Reports" press="onViewReports"/></headerContent><content><Toolbar id="_IDGenToolbar"><ToolbarSpacer id="_IDGenToolbarSpacer"/><Button id="_IDGenButton7" icon="sap-icon://nav-back" press="onPreviousWeekTS"/><Button id="_IDGenButton8" icon="sap-icon://navigation-right-arrow" press="onNextWeekTS"/><Button id="_IDGenButton11" text="Today" press="onCurrentWeekTS"/></Toolbar><IconTabBar id="iconTabBar" select="onTabSelect" expanded="true"><items><IconTabFilter id="timesheetTab" text="Timesheet" key="timesheet" icon="sap-icon://timesheet" iconColor="Critical"><Panel headerText="Daily Time Entry" expandable="true" expanded="true"><headerToolbar><Toolbar id="_IDGenToolbar2"><Title text="Daily Time Entry"></Title><ToolbarSpacer id="_IDGenToolbarSpacer2"/><Button icon="sap-icon://nav-back" tooltip="Previous Week"\n                    press="onPreviousWeekTS" type="Default"\n                    class="sapUiTinyMarginEnd"/><Button text="Current Week" tooltip="Current Week"\n                    press="onCurrentWeekTS" type="Emphasized"\n                    class="sapUiTinyMarginEnd"/><Button icon="sap-icon://navigation-right-arrow" tooltip="Next Week"\n                    press="onNextWeekTS" type="Default"\n                    class="sapUiTinyMarginEnd"/></Toolbar></headerToolbar><VBox class="sapUiSmallMargin"><HBox justifyContent="SpaceBetween" alignItems="Center" class="sapUiLargeMarginBottom"><Title text="Log Your Work Hours" level="H3" class="sapUiTinyMarginBegin"/><HBox alignItems="Center" class="sapUiTinyMarginEnd"><DatePicker id="datePicker"\n                    displayFormat="MMM dd, YYYY"\n                    value="{timeEntryModel>/selectedDate}"\n                    change="onDatePickerChange"\n                    placeholder="Select Date"\n                    width="160px"\n                    class="sapUiTinyMarginEnd"/><Button icon="sap-icon://add"\n                text="Record Time"\n                press="onAddEntry"\n                type="Emphasized"\n                class="sapUiTinyMarginEnd"/><Button icon="sap-icon://download"\n                text="PDF"\n                press="onDownloadPDF"\n                class="sapUiTinyMarginEnd"/></HBox></HBox><Table\n    id="timesheetTable"\n    items="{path: \'timeEntryModel>/timeEntries\'}"\n    class="sapUiSizeCompact"\n    alternateRowColors="true"\n    width="100%"><columns><Column width="7em"><Text text="Project"/></Column><Column width="7em"><Text text="Task"/></Column><Column width="6em" hAlign="Center"><Text text="Details"/></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Mon" design="Bold"/><Text text="{timeEntryModel>/weekDates/mondayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusMon" \n            text="{timeEntryModel>/dailyTotals/monday}" \n            class="sapUiSmallMarginTop"\n            state="{= ${timeEntryModel>/dailyTotals/monday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Tue" design="Bold"/><Text text="{timeEntryModel>/weekDates/tuesdayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusTue" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/tuesday}" \n            state="{= ${timeEntryModel>/dailyTotals/tuesday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Wed" design="Bold"/><Text text="{timeEntryModel>/weekDates/wednesdayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusWed" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/wednesday}" \n            state="{= ${timeEntryModel>/dailyTotals/wednesday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Thu" design="Bold"/><Text text="{timeEntryModel>/weekDates/thursdayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusThu" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/thursday}" \n            state="{= ${timeEntryModel>/dailyTotals/thursday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Fri" design="Bold"/><Text text="{timeEntryModel>/weekDates/fridayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusFri" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/friday}" \n            state="{= ${timeEntryModel>/dailyTotals/friday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Sat" design="Bold"/><Text text="{timeEntryModel>/weekDates/saturdayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusSat" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/saturday}" \n            state="{= ${timeEntryModel>/dailyTotals/saturday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="6em" hAlign="Center"><VBox alignItems="Center"><Label text="Sun" design="Bold"/><Text text="{timeEntryModel>/weekDates/sundayFormatted}"/><ObjectStatus \n            id="_IDGenObjectStatusSun" \n            class="sapUiSmallMarginTop"\n            text="{timeEntryModel>/dailyTotals/sunday}" \n            state="{= ${timeEntryModel>/dailyTotals/sunday} >= 8 ? \'Success\' : \'Error\' }"/></VBox></Column><Column width="8em" hAlign="Center" class="sapUiSmallMarginTop"><VBox alignItems="Center"><Label text="" design="Bold"/><Text text="Total Hours"/><ObjectStatus\n        text="{timeEntryModel>/totalWeekHours}"\n         class="sapUiSmallMarginTop"\n        state="Success"  /></VBox></Column><Column width="3em" hAlign="Center" class="sapUiSmallMarginTop"><VBox alignItems="Center"><Label text="" design="Bold"/><Text text=""/></VBox></Column></columns><items><ColumnListItem><cells><Text text="{timeEntryModel>projectName}"/><Text text="{timeEntryModel>workType}"/><Button icon="sap-icon://detail-view" type="Transparent"\n                        press="onTaskDetailPress"/><Button text="{timeEntryModel>mondayHours}"     press="onEditDailyHours"><customData><core:CustomData key="day" value="monday"/></customData></Button><Button text="{timeEntryModel>tuesdayHours}"    press="onEditDailyHours"><customData><core:CustomData key="day" value="tuesday"/></customData></Button><Button text="{timeEntryModel>wednesdayHours}" press="onEditDailyHours"><customData><core:CustomData key="day" value="wednesday"/></customData></Button><Button text="{timeEntryModel>thursdayHours}"  press="onEditDailyHours"><customData><core:CustomData key="day" value="thursday"/></customData></Button><Button text="{timeEntryModel>fridayHours}"    press="onEditDailyHours"><customData><core:CustomData key="day" value="friday"/></customData></Button><Button text="{timeEntryModel>saturdayHours}" type="Reject"\n                        press="onEditDailyHours"><customData><core:CustomData key="day" value="saturday"/></customData></Button><Button text="{timeEntryModel>sundayHours}" type="Reject"\n                        press="onEditDailyHours"><customData><core:CustomData key="day" value="sunday"/></customData></Button><Text text="{timeEntryModel>totalWeekHours}"></Text><Button icon="sap-icon://delete" type="Reject"\n                        visible="{timeEntryModel>canDelete}"\n                        press="onDeleteRows"/></cells></ColumnListItem></items></Table></VBox></Panel></IconTabFilter><IconTabFilter id="_IDGenIconTabFilter" text="Projects" key="projects" icon="sap-icon://background" iconColor="Positive"><Panel id="_IDGenPanel" headerText="Assigned Projects" expandable="true" expanded="true"><List id="projectsList" mode="SingleSelectMaster" items="{\n                path: \'assignedProjects>/assignedProjects\'\n            }" selectionChange="onProjectSelect"><StandardListItem\n                title="{assignedProjects>projectName}"      \n                description="{assignedProjects>managerName}" \n                info="{assignedProjects>status}"\n                infoState="{= ${assignedProjects>status} === \'Approved\' ? \'Success\' : ${assignedProjects>status} === \'On Hold\' ? \'Warning\' : \'Error\' }"\n                type="Active"/></List></Panel></IconTabFilter><IconTabFilter id="_IDGenIconTabFilter3" text="Reports" key="reportsTab" icon="sap-icon://bar-chart" iconColor="Negative"><Panel id="bookedHoursPanel" headerText="Booked Hours Overview" expandable="true" expanded="true"><headerToolbar><Toolbar id="_IDGenToolbar1"><Title id="_IDGenTitle1" text="Reports"/><ToolbarSpacer id="_IDGenToolbarSpacer1"/><Button id="refreshAnalyticsBtn" text="Refresh Data" icon="sap-icon://refresh" press="onRefreshAnalytics"/></Toolbar></headerToolbar><Table id="bookedHoursTable" items="{bookedHoursModel>/employeeProjectHours}"><columns><Column><Text text="Project"/></Column><Column><Text text="Allocated Hours"/></Column><Column><Text text="Booked Hours"/></Column><Column><Text text="Remaining Hours"/></Column><Column><Text text="Utilization"/></Column></columns><items><ColumnListItem><cells><Text text="{bookedHoursModel>Project}"/><Text text="{bookedHoursModel>AllocatedHours}"/><Text text="{bookedHoursModel>BookedHours}"/><Text text="{bookedHoursModel>RemainingHours}"/><Text text="{bookedHoursModel>Utilization}"/></cells></ColumnListItem></items></Table></Panel><Panel id="durationPanel" headerText="Project Engagement Duration" expandable="true" expanded="true"><Table id="durationTable" items="{durationModel>/employeeProjectDurations}"><columns><Column><Text text="Project"/></Column><Column><Text text="Start Date"/></Column><Column><Text text="End Date"/></Column><Column><Text text="Duration (Days)"/></Column><Column><Text text="Days Remaining"/></Column><Column><Text text="Timeline Status"/></Column></columns><items><ColumnListItem><cells><Text text="{durationModel>Project}"/><Text text="{path: \'durationModel>StartDate\', formatter: \'.formatDateDisplay\'}"/><Text text="{path: \'durationModel>EndDate\', formatter: \'.formatDateDisplay\'}"/><Text text="{durationModel>Duration}"/><Text text="{durationModel>DaysRemaining}"/><ObjectStatus \n            text="{durationModel>TimelineStatus}"\n            state="{= ${durationModel>TimelineStatus} === \'Completed\' ? \'Success\' :\n                     ${durationModel>TimelineStatus} === \'On Track\' ? \'Success\' :\n                     ${durationModel>TimelineStatus} === \'At Risk\' ? \'Warning\' :\n                     ${durationModel>TimelineStatus} === \'Delayed\' ? \'Error\' : \'None\' }"/></cells></ColumnListItem></items></Table></Panel></IconTabFilter></items></IconTabBar></content><footer></footer></Page></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
